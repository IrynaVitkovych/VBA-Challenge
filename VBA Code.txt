Sub Stock_Analysis()    Dim ws As Worksheet    Dim i As Long    Dim Lastrow As Long    Dim Total_Volume As Double    Dim Opening_Price As Double    Dim Closing_Price As Double    Dim Percent_Change As Double    Dim Yearly_Change As Double    Dim Greatest_Total_Volume As Double    Dim Greatest_Decrease As Double    Dim Greatest_Increase As Double    Dim Previous_Stock_Price As Long    Dim Ticke_Symbol As String    Dim j As Integer    For Each ws In Worksheets        'Initial variables        j = 0        Previous_Stock_Price = 2        'Add summary columns headers in the first row        ws.Range("I1, Q1").Value = "Ticker"        ws.Range("J1").Value = "Yearly Change"        ws.Range("K1").Value = "Percent Change"        ws.Range("L1").Value = "Total Stock Volume"        ws.Range("R1").Value = "Value"        'Add summary rows headers        ws.Range("P2").Value = "Greatest % Increase"        ws.Range("P3").Value = "Greatest % Decrease"        ws.Range("P4").Value = "Greatest Total Volume"        'Adjust the columns width        Columns(9).AutoFit        Columns(10).AutoFit        Columns(11).AutoFit        Columns(12).AutoFit        Columns(13).AutoFit        Columns(16).AutoFit        Columns(17).AutoFit        Columns(18).AutoFit       ' Loop for Ticker Symbol, Yearly Change, Percent Change, Total Stock Volume, and Green/Red Highlight        'Set the last row        Lastrow = ws.Cells(Rows.Count, "A").End(xlUp).Row        For i = 2 To Lastrow            If ws.Cells(i, 1).Value <> ws.Cells(i + 1, 1).Value Then                ' Set Ticker Symbol                Ticker = ws.Cells(i, 1).Value                ' Add to the Total Volume                Total_Volume = Total_Volume + ws.Cells(i, 7).Value                ' Set the Opening Price                Opening_Price = ws.Cells(Previous_Stock_Price, 3).Value                ' Set the Closing Price                Closing_Price = ws.Cells(i, 6).Value                ' Calculate the Yearly Change                Yearly_Change = Closing_Price - Opening_Price                ' Calculate the Percent Change                If Opening_Price <> 0 Then                    Percent_Change = Yearly_Change / Opening_Price                Else                    Percent_Change = 0                End If                            ' output Ticker Symbol                ws.Range("I" & 2 + j).Value = Ticker                ' output Total Volume                ws.Range("L" & 2 + j).Value = Total_Volume                ' output Yearly Change                ws.Range("J" & 2 + j).Value = Yearly_Change                ' output Percent Change                ws.Range("K" & 2 + j).Value = Percent_Change                ws.Range("K" & 2 + j).NumberFormat = "0.00%"                                    ' If statement to highlight a positive change in a green and negative change in the red              If ws.Range("J" & 2 + j).Value >= 0 Then              ws.Range("J" & 2 + j).Interior.ColorIndex = 4              Else              ws.Range("J" & 2 + j).Interior.ColorIndex = 3              End If                ' Update variables                j = j + 1                ' Reset Total Volume                Total_Volume = 0                ' Move to the next ticker's opening price                Previous_Stock_Price = i + 1            Else                ' Add to the Total Volume                Total_Volume = Total_Volume + ws.Cells(i, 7).Value            End If            Next i            ' Loop for Greatest % Increase, Greatest % Decrease, and Greatest Total Volume                'Initial variables        Greatest_Increase = 0        Greatest_Decrease = 0        Greatest_Total_Volume = 0                'Set the last row        Lastrow = ws.Cells(Rows.Count, "A").End(xlUp).Row        For i = 2 To Lastrow                ' If statement to find the Greatest Total Volume         If ws.Range("L" & i).Value > Greatest_Total_Volume Then            Greatest_Total_Volume = ws.Range("L" & i).Value            Ticker_Symbol = ws.Range("I" & i).Value                          'output Ticker Symbol and Value for Greatest Total Volume             ws.Range("R4").Value = Greatest_Total_Volume             ws.Range("Q4").Value = Ticker_Symbol                 End If                 ' If statement to find the Greatest % Decrease           If ws.Range("K" & i).Value < Greatest_Decrease Then            Greatest_Decrease = ws.Range("K" & i).Value            Ticker_Symbol = ws.Range("I" & i).Value                          'output Ticker Symbol and Value for the Greatest % Decrease             ws.Range("R3").Value = Greatest_Decrease             ws.Range("Q3").Value = Ticker_Symbol             ws.Range("R3").NumberFormat = "0.00%"                     End If                   ' If statement to find the Greatest % Increase           If ws.Range("K" & i).Value > Greatest_Increase Then            Greatest_Increase = ws.Range("K" & i).Value            Ticker_Symbol = ws.Range("I" & i).Value                          'output Ticker Symbol and Value for the Greatest % Increase             ws.Range("R2").Value = Greatest_Increase             ws.Range("Q2").Value = Ticker_Symbol             ws.Range("R2").NumberFormat = "0.00%"                     End If                             Next i       Next wsEnd Sub